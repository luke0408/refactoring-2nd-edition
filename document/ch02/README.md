# Ch02. 리팩터링 원칙

Chapter 1에서 리팩터링이 무엇인지 충분히 감을 잡아보았다.

이를 토대로 이번 장에서는 리팩터링 전반에 적용되는 원칙 몇가지를 설명한다.

## 2.1 리팩터링 정의

> 누군가 "리팩터링하다 코드가 깨져서 며칠이나 고생했다"라고 한다면, 십중팔구 리팩터링 한 것이 아니다.

수많은 다른 소프트웨어 개발 용어와 마찬가지로 리팩터링(Refactoring)도 엔지니어들 사이에서 다소 두리뭉실한 의미로 사용됩니다. 하지만, 마틴 파울러는 리팩터링의 의미를 더 구체적으로, 다소 엄격하게 정의함으로써 더 유용하게 사용하고자 합니다.

> 리팩터링: [명사] 소프트웨어의 겉보기 동작은 그대로 유지한 채, 코드를 이해하고 수정하기 쉽도록 내부 구조를 변경하는 기법

앞 장에서 본 함수 추출하기와 조건부 로직을 다형성으로 바꾸기 처럼 이름 붙은 리팩터링 기법들이 위 정의에 해당합니다.

> 리팩터링(하다): [동사] 소프트웨어의 걷보기 동작은 그대로 유지한 채, 여러가지 리팩터링 기법을 적용해서 소프트웨어를 재구성하다.

지금껏 저는 책에서 소개하는 여느 사람들처럼 코드를 정리하는 작업을 모조리 "리팩터링"이라고 표현해왔습니다. 하지만, 마틴 파울러는 위에서 정의한 의미와 같이 `특정한 방식에 따라 코드를 정리하는 것 만이 리팩터링이다`라고 설명하고 있죠.

즉, 이전 챕터에서 했던 것 처럼 리팩터링은 아주 작은 단위로 단계를 나누어 쌓아가는 것임으로 리팩터링하는 동안에는 코드가 항상 정상 작동하기 때문에 전체 작업이 끝나지 않았더라도 언제든 멈출 수 있습니다.

### 리팩터링 vs 성능 최적화

리팩터링과 성능 최적화는 둘 다 코드를 변경하며 프로그램의 전반적인 기능은 그대로 유지하지만, 그 목적이 상이합니다.

리팩터링의 목적은 `코드를 이해하고 수정하기 쉽게 만드는 것`으로, 프로그램의 성능이 나빠지거나 좋아질 수 있습니다.

반면 성능 최적화는 오로지 속도 개선에만 신경을 씁니다. 때문에 목표 성능에 반드시 도달해야 한다면 코드를 다루기에 더 어렵게 수정할수도 있습니다.

## 2.2 두 개의 모자

켄트 백은 개발의 목적 분리 작업을 두 개의 모자에 비유합니다. 

기능을 추가할 때는 "기능 추가" 모자를 쓴 다음 기존 코드는 절대 건드리지 않고 새 기능을 추가하기만 합니다. 진척도는 `테스트를 추가해서 통과하는지 확인`하는 방식으로 진행합니다.

또한, 리팩터링을 할 때에는 "리팩터링" 모자를 쓴 다음 기능 추가는 절대 하지 않기로 다짐한 뒤 오로지 코드 재구성에만 전념합니다. 이때는 앞 과정에서 놓친 테스트 케이스를 발견한게 아닌 이상 `테스트를 추가하지 않습니다.` 

이러한 각각의 작업시간은 10분 미만으로 짧을 수 있습니다. 그럼에도 마틴 파울러는 항상 내가 쓰고 있는 모자가 무엇인지와 그에 따른 미묘한 작업 방식의 차이를 분명하게 인지할 것을 권장합니다.
